{% extends 'home/header.html' %}

{% load static %}
{% load markdown %}


{% block head %}
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Exo+2:wght@300&display=swap" rel="stylesheet">

<link rel="stylesheet" href="{% static 'home/css/index.css' %}">
<link rel="stylesheet" href="{% static 'home/css/subdomains/genome.css' %}">
{% endblock %}


{% block content %}


<main>
  {% include 'home/subdomains/components/info-modal.html' %}
  {% include 'home/subdomains/components/community-modal.html' %}
  {% include 'home/subdomains/components/feedback.html' with subdomain='genome' %}

  <section  class="header-genome australia d-flex align-items-center h-100">
    <img id="header-logo" src="{% static 'home/img/subdomains/genome/logo.png' %}" alt="Galaxy Australia Logo">
    GENOMES LAB
  </section>

  <section class="my-5" id="tagline">
    {% include 'home/snippets/static-notices.html' %}

    <p>
      Welcome to the Galaxy Australia Genomes Lab. Get quick access to tools, workflows and tutorials for genome assembly and annotation.
      <a
        href="#"
        data-bs-toggle="modal"
        data-bs-target="#infoModal">
        What is this page?
      </a>
    </p>
  </section>

  {% for section in sections %}
    <!-- Data section only for now -->
    {% include 'home/subdomains/components/section.html' with section=section %}
  {% endfor %}

  <section class="my-5">
    <h4 class="mb-3">What's happening in Australian genomics research?</h4>
    <button
      class="ga-btn"
      data-bs-toggle="modal"
      data-bs-target="#communityConnectModal"
    >
      Explore
    </button>
    <br>
    <br>
    <h4 class="mb-3">What do you think of the Genomes Lab?</h4>
    <button
      class="ga-btn"
      data-bs-toggle="modal"
      data-bs-target="#feedbackModal"
    >
      Give feedback
    </button>
  </section>
</main>

{% endblock %}


{% block script %}
{% endblock %}


{% block onload %}
  // Ensure that notice links open in new tab if external
  $('.notice a').each( (i, item) => {
    if (!item.href.includes("{{ HOSTNAME }}")) {
      item.target = '_blank';
    }
  });

  // TODO: Remove - development only (don't leave behind TBC text)
  $('p').filter( (i, el) => el.innerText.toLowerCase().includes('tbc') ).each(
    (i, item) => {
      item.innerHTML = item.innerHTML
        .replace('TBC', '<span class="text-danger fw-bold">TBC</span>')
        .replace('tbc', '<span class="text-danger fw-bold">TBC</span>');
      $(item).closest('.accordion-item').find('.accordion-button').addClass('bg-danger');
      const paneId = $(item).closest('.tab-pane')[0].id;
      $(`#${paneId.replace('-panel', '-tab')}`).addClass('bg-danger');
    }
  );
{% endblock %}
